<html>
<head>
  <meta charset="UTF-8">
  <title>Check-In</title>
  <script>
    function getParameterByName(name) {
      const url = window.location.href;
      name = name.replace(/[
    
]/g, '\\');
      const regex = new RegExp('[?   ]' + name + '(=([^   #]*)|   |#|)');
      const results = regex.exec(url);
      if (!results) return null;
      if (!results[2]) return '';
      return decodeURIComponent(results[2].replace(/\+/g, ' '));
    }

    function sendData(id, latitude, longitude) {
      console.log("A enviar dados:", { id, latitude, longitude });

      fetch('https://script.google.com/macros/s/AKfycbzLkJLHgdSxN1tCQIFWhCfu2bf7zMdTE-Axwz1aRQ1ov_yvq5rQVp_q4MWuW4lvWerw/exec', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ id, latitude, longitude })
      })
      .then(response => response.text())
      .then(data => {
        console.log("Resposta do servidor:", data);
        document.getElementById('status').innerText = '‚úÖ Check-in realizado com sucesso!';
      })
      .catch(error¬†=>¬†{console.error('Erro no fetch:', error);
        document.getElementById('status').innerText = '‚ùå Erro ao enviar dados: ' + error.message;
      });
    }

    function getLocationAndSend() {
      const id = getParameterByName('id') || "Guilherme Santos";
      console.log("ID detectado:", id);

      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(
          position => {
            console.log("Localiza√ß√£o obtida:", position.coords);
            sendData(id, position.coords.latitude, position.coords.longitude);
          },
          error => {
            console.error('Erro na geolocaliza√ß√£o:', error);
            document.getElementById('status').innerText = '‚ùó Erro na localiza√ß√£o: ' + error.message;
          }
        );
      } else {
        document.getElementById('status').innerText = '‚ùó Geolocaliza√ß√£o n√£o suportada.';
        console.error('Geolocaliza√ß√£o n√£o suportada.');
      }
    }

    window.onload = getLocationAndSend;
  </script>
</head>
<body>
  <h2>Check-In</h2>
  <p id="status">üìç A obter localiza√ß√£o e enviar dados...AGUARDE</p>
</body>
</html>




